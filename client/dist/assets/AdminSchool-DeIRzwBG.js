import{F as d,r as h,w as v,x as D,y as _,z as $,j as e,I as S,B as x,A as B,M as f,s as l,v as N}from"./index-DXH8-aom.js";import{A as O}from"./AdminLayout-CmhUVznm.js";import{S as j}from"./index-DIMzJkL2.js";import{F as P}from"./Table-DgNXMo5d.js";import{R as V}from"./DeleteOutlined-OmZTE6aX.js";import"./CalendarOutlined-DmTqm3dq.js";import"./Pagination-B6IcXys1.js";import"./DownOutlined-B9IIpr-u.js";import"./index-B25cUSsw.js";const X=()=>{const[n]=d.useForm(),[k,u]=h.useState(!1),[c,F]=h.useState(""),[r,m]=h.useState(null),[t,g]=h.useState({current:1,pageSize:10}),[I,{data:i,isLoading:w}]=v(),[z]=D(),[A]=_(),p=async(a=1,s=10,o="")=>{try{await I({page:a,limit:s,search:o})}catch{l.error("Failed to fetch schools")}};$.useEffect(()=>{p(t.current,t.pageSize,c)},[t.current,t.pageSize,c]);const M=a=>{g(a)},b=a=>{F(a),g({...t,current:1})},y=(a=null)=>{m(a),a?n.setFieldsValue({id:a.id,name:a.nama}):n.resetFields(),u(!0)},C=()=>{u(!1),m(null),n.resetFields()},T=async()=>{try{const a=await n.validateFields();await z(a),l.success(`School ${r?"updated":"added"} successfully`),u(!1),m(null),n.resetFields(),p(t.current,t.pageSize,c)}catch{l.error(`Failed to ${r?"update":"add"} school`)}},E=async a=>{f.confirm({title:"Apakah anda yakin ingin menghapus sekolah ini?",content:"Data sekolah akan dihapus secara permanen",okText:"Ya",cancelText:"Tidak",onOk:async()=>{var s;try{const o=await A(a);l.success(o.message),p(t.current,t.pageSize,c)}catch(o){l.error(((s=o.data)==null?void 0:s.message)||"Failed to delete school")}}})},R=[{title:"No",key:"no",render:(a,s,o)=>(t.current-1)*t.pageSize+o+1},{title:"School Name",dataIndex:"nama",key:"nama"},{title:"Action",key:"action",render:(a,s)=>e.jsxs(j,{size:"middle",children:[e.jsx(x,{type:"primary",icon:e.jsx(N,{}),onClick:()=>y(s),children:"Edit"}),e.jsx(x,{type:"primary",danger:!0,icon:e.jsx(V,{}),onClick:()=>E(s.id),children:"Delete"})]})}];return e.jsxs(O,{title:"Sekolah",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(j,{children:[e.jsx(S.Search,{placeholder:"Search schools",onSearch:b,style:{width:200}}),e.jsx(x,{type:"primary",icon:e.jsx(B,{}),onClick:()=>y(),children:"Add School"})]})}),e.jsx(P,{columns:R,dataSource:i==null?void 0:i.schools,rowKey:"id",pagination:{...t,total:(i==null?void 0:i.totalPages)*t.pageSize},loading:w,onChange:M}),e.jsx(f,{title:r?"Edit School":"Add School",open:k,onOk:T,onCancel:C,children:e.jsxs(d,{form:n,layout:"vertical",children:[r&&e.jsx(d.Item,{name:"id",label:"ID",children:e.jsx(S,{disabled:!0})}),e.jsx(d.Item,{name:"name",label:"School Name",rules:[{required:!0,message:"Please input school name!"}],children:e.jsx(S,{})})]})})]})};export{X as default};
