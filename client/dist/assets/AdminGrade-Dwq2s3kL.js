import{M as d,r as u,W as E,X as R,Y as D,e as N,j as e,I as g,B as x,V as O,N as v,s as l,O as V}from"./index-RHHBljLG.js";import{A as _}from"./AdminLayout-CiY23PjN.js";import{S as f}from"./index-3dm-DB3h.js";import{F as $}from"./Table-BE48RBVr.js";import{R as B}from"./DeleteOutlined-D8i8376n.js";import"./CalendarOutlined-BVNSOuCo.js";import"./Pagination-B7GxbH25.js";import"./DownOutlined-CJiERgwC.js";import"./index-BOXVYCkk.js";const U=()=>{const[i]=d.useForm(),[S,m]=u.useState(!1),[o,L]=u.useState(""),[c,p]=u.useState(null),[t,j]=u.useState({current:1,pageSize:10}),[k,{data:r,isLoading:F}]=E(),[b]=R(),[I]=D(),h=async(a=1,s=10,n="")=>{try{await k({page:a,limit:s,search:n})}catch{l.error("Failed to fetch levels")}};N.useEffect(()=>{h(t.current,t.pageSize,o)},[t.current,t.pageSize,o]);const M=a=>{j(a)},w=a=>{L(a),j({...t,current:1})},y=(a=null)=>{p(a),a?i.setFieldsValue({id:a.id,name:a.nama}):i.resetFields(),m(!0)},z=()=>{m(!1),p(null),i.resetFields()},A=async()=>{try{const a=await i.validateFields();await b(a),l.success(`Jenjang berhasil ${c?"diperbarui":"ditambahkan"} `),m(!1),p(null),i.resetFields(),h(t.current,t.pageSize,o)}catch{l.error(`Failed to ${c?"update":"add"} level`)}},C=async a=>{v.confirm({title:"Apakah anda yakin ingin menghapus jenjang ini?",content:"Data jenjang akan dihapus secara permanen",okText:"Ya",cancelText:"Tidak",onOk:async()=>{var s;try{const n=await I(a);l.success(n.message),h(t.current,t.pageSize,o)}catch(n){l.error(((s=n.data)==null?void 0:s.message)||"Failed to delete level")}}})},T=[{title:"No",key:"no",render:(a,s,n)=>(t.current-1)*t.pageSize+n+1},{title:"Level Name",dataIndex:"nama",key:"nama"},{title:"Action",key:"action",render:(a,s)=>e.jsxs(f,{size:"middle",children:[e.jsx(x,{type:"primary",icon:e.jsx(V,{}),onClick:()=>y(s),children:"Edit"}),e.jsx(x,{type:"primary",danger:!0,icon:e.jsx(B,{}),onClick:()=>C(s.id),children:"Delete"})]})}];return e.jsxs(_,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(f,{children:[e.jsx(g.Search,{placeholder:"Search levels",onSearch:w,style:{width:200}}),e.jsx(x,{type:"primary",icon:e.jsx(O,{}),onClick:()=>y(),children:"Add Level"})]})}),e.jsx($,{columns:T,dataSource:r==null?void 0:r.levels,rowKey:"id",pagination:{...t,total:(r==null?void 0:r.totalPages)*t.pageSize},loading:F,onChange:M}),e.jsx(v,{title:c?"Edit Level":"Add Level",open:S,onOk:A,onCancel:z,children:e.jsxs(d,{form:i,layout:"vertical",children:[c&&e.jsx(d.Item,{name:"id",label:"ID",children:e.jsx(g,{disabled:!0})}),e.jsx(d.Item,{name:"name",label:"Level Name",rules:[{required:!0,message:"Please input level name!"}],children:e.jsx(g,{})})]})})]})};export{U as default};
