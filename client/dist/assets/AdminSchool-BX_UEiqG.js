import{M as d,r as h,P as D,Q as v,U as N,e as O,j as e,I as S,B as x,V as P,N as f,s as i,O as V}from"./index-RHHBljLG.js";import{A as _}from"./AdminLayout-CiY23PjN.js";import{S as j}from"./index-3dm-DB3h.js";import{F as $}from"./Table-BE48RBVr.js";import{R as B}from"./DeleteOutlined-D8i8376n.js";import"./CalendarOutlined-BVNSOuCo.js";import"./Pagination-B7GxbH25.js";import"./DownOutlined-CJiERgwC.js";import"./index-BOXVYCkk.js";const X=()=>{const[n]=d.useForm(),[k,u]=h.useState(!1),[r,F]=h.useState(""),[l,m]=h.useState(null),[t,g]=h.useState({current:1,pageSize:10}),[I,{data:c,isLoading:M}]=D(),[w]=v(),[z]=N(),p=async(a=1,s=10,o="")=>{try{await I({page:a,limit:s,search:o})}catch{i.error("Failed to fetch schools")}};O.useEffect(()=>{p(t.current,t.pageSize,r)},[t.current,t.pageSize,r]);const A=a=>{g(a)},b=a=>{F(a),g({...t,current:1})},y=(a=null)=>{m(a),a?n.setFieldsValue({id:a.id,name:a.nama}):n.resetFields(),u(!0)},C=()=>{u(!1),m(null),n.resetFields()},T=async()=>{try{const a=await n.validateFields();await w(a),i.success(`School ${l?"updated":"added"} successfully`),u(!1),m(null),n.resetFields(),p(t.current,t.pageSize,r)}catch{i.error(`Failed to ${l?"update":"add"} school`)}},E=async a=>{f.confirm({title:"Apakah anda yakin ingin menghapus sekolah ini?",content:"Data sekolah akan dihapus secara permanen",okText:"Ya",cancelText:"Tidak",onOk:async()=>{var s;try{const o=await z(a);i.success(o.message),p(t.current,t.pageSize,r)}catch(o){i.error(((s=o.data)==null?void 0:s.message)||"Failed to delete school")}}})},R=[{title:"No",key:"no",render:(a,s,o)=>(t.current-1)*t.pageSize+o+1},{title:"School Name",dataIndex:"nama",key:"nama"},{title:"Action",key:"action",render:(a,s)=>e.jsxs(j,{size:"middle",children:[e.jsx(x,{type:"primary",icon:e.jsx(V,{}),onClick:()=>y(s),children:"Edit"}),e.jsx(x,{type:"primary",danger:!0,icon:e.jsx(B,{}),onClick:()=>E(s.id),children:"Delete"})]})}];return e.jsxs(_,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(j,{children:[e.jsx(S.Search,{placeholder:"Search schools",onSearch:b,style:{width:200}}),e.jsx(x,{type:"primary",icon:e.jsx(P,{}),onClick:()=>y(),children:"Add School"})]})}),e.jsx($,{columns:R,dataSource:c==null?void 0:c.schools,rowKey:"id",pagination:{...t,total:(c==null?void 0:c.totalPages)*t.pageSize},loading:M,onChange:A}),e.jsx(f,{title:l?"Edit School":"Add School",open:k,onOk:T,onCancel:C,children:e.jsxs(d,{form:n,layout:"vertical",children:[l&&e.jsx(d.Item,{name:"id",label:"ID",children:e.jsx(S,{disabled:!0})}),e.jsx(d.Item,{name:"name",label:"School Name",rules:[{required:!0,message:"Please input school name!"}],children:e.jsx(S,{})})]})})]})};export{X as default};
