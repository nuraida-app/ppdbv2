import{F as d,r as u,D as T,E as D,G as R,z as _,j as e,I as g,B as x,A as $,M as y,s as l,v as B}from"./index-DXH8-aom.js";import{A as G}from"./AdminLayout-CmhUVznm.js";import{S as f}from"./index-DIMzJkL2.js";import{F as N}from"./Table-DgNXMo5d.js";import{R as O}from"./DeleteOutlined-OmZTE6aX.js";import"./CalendarOutlined-DmTqm3dq.js";import"./Pagination-B6IcXys1.js";import"./DownOutlined-B9IIpr-u.js";import"./index-B25cUSsw.js";const X=()=>{const[i]=d.useForm(),[S,m]=u.useState(!1),[o,L]=u.useState(""),[c,p]=u.useState(null),[t,j]=u.useState({current:1,pageSize:10}),[k,{data:r,isLoading:F}]=T(),[b]=D(),[I]=R(),h=async(a=1,s=10,n="")=>{try{await k({page:a,limit:s,search:n})}catch{l.error("Failed to fetch levels")}};_.useEffect(()=>{h(t.current,t.pageSize,o)},[t.current,t.pageSize,o]);const z=a=>{j(a)},A=a=>{L(a),j({...t,current:1})},v=(a=null)=>{p(a),a?i.setFieldsValue({id:a.id,name:a.nama}):i.resetFields(),m(!0)},M=()=>{m(!1),p(null),i.resetFields()},w=async()=>{try{const a=await i.validateFields();await b(a),l.success(`Jenjang berhasil ${c?"diperbarui":"ditambahkan"} `),m(!1),p(null),i.resetFields(),h(t.current,t.pageSize,o)}catch{l.error(`Failed to ${c?"update":"add"} level`)}},C=async a=>{y.confirm({title:"Apakah anda yakin ingin menghapus jenjang ini?",content:"Data jenjang akan dihapus secara permanen",okText:"Ya",cancelText:"Tidak",onOk:async()=>{var s;try{const n=await I(a);l.success(n.message),h(t.current,t.pageSize,o)}catch(n){l.error(((s=n.data)==null?void 0:s.message)||"Failed to delete level")}}})},E=[{title:"No",key:"no",render:(a,s,n)=>(t.current-1)*t.pageSize+n+1},{title:"Level Name",dataIndex:"nama",key:"nama"},{title:"Action",key:"action",render:(a,s)=>e.jsxs(f,{size:"middle",children:[e.jsx(x,{type:"primary",icon:e.jsx(B,{}),onClick:()=>v(s),children:"Edit"}),e.jsx(x,{type:"primary",danger:!0,icon:e.jsx(O,{}),onClick:()=>C(s.id),children:"Delete"})]})}];return e.jsxs(G,{title:"Jenjang",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(f,{children:[e.jsx(g.Search,{placeholder:"Search levels",onSearch:A,style:{width:200}}),e.jsx(x,{type:"primary",icon:e.jsx($,{}),onClick:()=>v(),children:"Add Level"})]})}),e.jsx(N,{columns:E,dataSource:r==null?void 0:r.levels,rowKey:"id",pagination:{...t,total:(r==null?void 0:r.totalPages)*t.pageSize},loading:F,onChange:z}),e.jsx(y,{title:c?"Edit Level":"Add Level",open:S,onOk:w,onCancel:M,children:e.jsxs(d,{form:i,layout:"vertical",children:[c&&e.jsx(d.Item,{name:"id",label:"ID",children:e.jsx(g,{disabled:!0})}),e.jsx(d.Item,{name:"name",label:"Level Name",rules:[{required:!0,message:"Please input level name!"}],children:e.jsx(g,{})})]})})]})};export{X as default};
