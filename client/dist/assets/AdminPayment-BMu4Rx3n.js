import{r as l,m as T,n as v,o as w,j as e,T as B,S as d,R as F,C as p,a as x,I as A,B as m,p as L,q as D,s as u}from"./index-4d5g1BaK.js";import{A as N}from"./AdminLayout-COybAYRu.js";import{S as h,R as z}from"./index-CW_gfXft.js";import{S as y}from"./index-BbFLOugA.js";import{F as E}from"./Table-Ba6HjrdG.js";import{P as G}from"./Pagination--wBnr7Wj.js";import"./CalendarOutlined-CunE1jvP.js";import"./index-sxBtqBPa.js";import"./index-Hv3UHrZV.js";const f=t=>{if(t==null)return"Rp 0";const s=typeof t=="string"?parseFloat(t):t;return isNaN(s)?"Rp 0":`Rp ${new Intl.NumberFormat("id-ID",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}`},{Title:_}=B,V=()=>{const[t,s]=l.useState(1),[o]=l.useState(10),[g,j]=l.useState(""),[c,k]=l.useState(""),{data:r,isLoading:S}=T({page:t,limit:o,search:g}),{data:n,isLoading:I}=v(),[P]=w(),b=a=>{a.preventDefault(),j(c),s(1)},C=async a=>{try{await P(a).unwrap(),u.success("Pembayaran berhasil dikonfirmasi")}catch(i){u.error("Gagal mengkonfirmasi pembayaran"),console.error("Error confirming payment:",i)}},R=[{title:"Nama",dataIndex:"nama",key:"nama"},{title:"Nominal",dataIndex:"nominal",key:"nominal",render:a=>f(a)},{title:"Telepon",dataIndex:"tlp",key:"tlp"},{title:"Berkas",dataIndex:"berkas",key:"berkas",render:a=>e.jsx(m,{type:"link",icon:e.jsx(D,{}),href:a,target:"_blank",rel:"noopener noreferrer",children:"Lihat Berkas"})},{title:"Status",dataIndex:"ket",key:"ket",render:a=>e.jsx("span",{style:{color:a?"#52c41a":"#faad14"},children:a?"Terkonfirmasi":"Belum Dikonfirmasi"})},{title:"Aksi",key:"action",render:(a,i)=>e.jsx(y,{children:e.jsx(m,{type:"primary",icon:e.jsx(z,{}),onClick:()=>C(i.user_id),disabled:i.ket,children:i.ket?"Terkonfirmasi":"Konfirmasi"})})}];return e.jsx(N,{title:"Data Pembayaran",children:e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(_,{level:2,children:"Data Pembayaran"}),I?e.jsx(d,{}):e.jsxs(F,{gutter:16,style:{marginBottom:"24px"},children:[e.jsx(p,{span:12,children:e.jsx(x,{children:e.jsx(h,{title:"Total Pembayaran",value:(n==null?void 0:n.total)||0,formatter:a=>f(a)})})}),e.jsx(p,{span:12,children:e.jsx(x,{children:e.jsx(h,{title:"Jumlah Transaksi",value:(n==null?void 0:n.jml)||0})})})]}),e.jsx("form",{onSubmit:b,style:{marginBottom:"24px"},children:e.jsxs(y,{children:[e.jsx(A,{placeholder:"Cari pembayaran",value:c,onChange:a=>k(a.target.value),style:{width:300}}),e.jsx(m,{type:"primary",icon:e.jsx(L,{}),htmlType:"submit",children:"Cari"})]})}),S?e.jsx("div",{style:{textAlign:"center",padding:"50px"},children:e.jsx(d,{size:"large"})}):e.jsxs(e.Fragment,{children:[e.jsx(E,{columns:R,dataSource:r==null?void 0:r.payments,rowKey:"id",pagination:!1}),e.jsx("div",{style:{marginTop:"16px",textAlign:"center"},children:e.jsx(G,{current:t,total:(r==null?void 0:r.totalPages)*o,pageSize:o,onChange:a=>s(a),showSizeChanger:!1})})]})]})})};export{V as default};
