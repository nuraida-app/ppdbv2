import{r as l,A as b,D as v,E as w,j as e,T as F,S as d,R as A,C as p,a as x,I as B,B as m,F as L,G as D,s as u}from"./index-RHHBljLG.js";import{A as N}from"./AdminLayout-CiY23PjN.js";import{S as h,R as E}from"./index-zLPpSbFH.js";import{S as f}from"./index-3dm-DB3h.js";import{F as G}from"./Table-BE48RBVr.js";import{P as z}from"./Pagination-B7GxbH25.js";import"./CalendarOutlined-BVNSOuCo.js";import"./DownOutlined-CJiERgwC.js";import"./index-BOXVYCkk.js";const y=t=>{if(t==null)return"Rp 0";const s=typeof t=="string"?parseFloat(t):t;return isNaN(s)?"Rp 0":`Rp ${new Intl.NumberFormat("id-ID",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}`},{Title:_}=F,V=()=>{const[t,s]=l.useState(1),[o]=l.useState(10),[g,j]=l.useState(""),[c,k]=l.useState(""),{data:r,isLoading:S}=b({page:t,limit:o,search:g}),{data:n,isLoading:I}=v(),[P]=w(),C=a=>{a.preventDefault(),j(c),s(1)},R=async a=>{try{await P(a).unwrap(),u.success("Pembayaran berhasil dikonfirmasi")}catch(i){u.error("Gagal mengkonfirmasi pembayaran"),console.error("Error confirming payment:",i)}},T=[{title:"Nama",dataIndex:"nama",key:"nama"},{title:"Nominal",dataIndex:"nominal",key:"nominal",render:a=>y(a)},{title:"Telepon",dataIndex:"tlp",key:"tlp"},{title:"Berkas",dataIndex:"berkas",key:"berkas",render:a=>e.jsx(m,{type:"link",icon:e.jsx(D,{}),href:a,target:"_blank",rel:"noopener noreferrer",children:"Lihat Berkas"})},{title:"Status",dataIndex:"ket",key:"ket",render:a=>e.jsx("span",{style:{color:a?"#52c41a":"#faad14"},children:a?"Terkonfirmasi":"Belum Dikonfirmasi"})},{title:"Aksi",key:"action",render:(a,i)=>e.jsx(f,{children:e.jsx(m,{type:"primary",icon:e.jsx(E,{}),onClick:()=>R(i.user_id),disabled:i.ket,children:i.ket?"Terkonfirmasi":"Konfirmasi"})})}];return e.jsx(N,{children:e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(_,{level:2,children:"Data Pembayaran"}),I?e.jsx(d,{}):e.jsxs(A,{gutter:16,style:{marginBottom:"24px"},children:[e.jsx(p,{span:12,children:e.jsx(x,{children:e.jsx(h,{title:"Total Pembayaran",value:(n==null?void 0:n.total)||0,formatter:a=>y(a)})})}),e.jsx(p,{span:12,children:e.jsx(x,{children:e.jsx(h,{title:"Jumlah Transaksi",value:(n==null?void 0:n.jml)||0})})})]}),e.jsx("form",{onSubmit:C,style:{marginBottom:"24px"},children:e.jsxs(f,{children:[e.jsx(B,{placeholder:"Cari pembayaran",value:c,onChange:a=>k(a.target.value),style:{width:300}}),e.jsx(m,{type:"primary",icon:e.jsx(L,{}),htmlType:"submit",children:"Cari"})]})}),S?e.jsx("div",{style:{textAlign:"center",padding:"50px"},children:e.jsx(d,{size:"large"})}):e.jsxs(e.Fragment,{children:[e.jsx(G,{columns:T,dataSource:r==null?void 0:r.payments,rowKey:"id",pagination:!1}),e.jsx("div",{style:{marginTop:"16px",textAlign:"center"},children:e.jsx(z,{current:t,total:(r==null?void 0:r.totalPages)*o,pageSize:o,onChange:a=>s(a),showSizeChanger:!1})})]})]})})};export{V as default};
